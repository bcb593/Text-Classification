import numpy as np
import pandas as pd

# Load the data which contains movie reviews, tab separated files.  
df = pd.read_csv('../TextFiles/moviereviews.tsv', sep='\t')

#Check the first five rows of tbhe file
df.head(4)
len(df)

#Check the null values
df.isnull().sum()

#Drop the null values
df.dropna(inplace=True)
df.isnull().sum()
len(df)

X=df['review']
y=df['label']
from sklearn.model_selection import train_test_split
X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=42)


from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.pipeline import Pipeline
from sklearn.svm import LinearSVC
text_clf=Pipeline([('tfidf',TfidfVectorizer()),('clf',LinearSVC())])
text_clf.fit(X_train,y_train)
predictions=text_clf.predict(X_test)
from sklearn.metrics import confusion_matrix, classification_report
print(confusion_matrix(y_test,predictions))
print(classification_report(y_test,predictions))

#Predict your own review
text_clf.predict(["Great movie! Absolutely amazing. Had an amazing experience."])

